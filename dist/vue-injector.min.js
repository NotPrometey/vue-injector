/*!
  * @scandltd/vue-injector v1.0.4
  * (c) 2018 Scandltd
  * @license GPL-2.0
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.VueInjector={})}(this,function(e){"use strict";var o=void 0;function c(e,t){if(!e)throw new Error("[@scandltd/vue-injector] "+t)}var t="undefined"!=typeof window,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},s=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),u=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},f=function e(){i(this,e)},r=function(){function r(e,t){i(this,r),this.rootProviders=[],this.app=e,this.rootProviders=t,this.services=new Map}return s(r,[{key:"_injectService",value:function(r,e){e.forEach(function(e){var t=e.name;!Object.hasOwnProperty.call(r,t)&&e.service&&Reflect.defineProperty(r,t,{enumerable:!0,get:function(){return e.service}})})}},{key:"_checkObject",value:function(e){return!Array.isArray(e)&&"object"===(void 0===e?"undefined":n(e))&&null!==e}},{key:"_checkGetName",value:function(e){return!(!Object.hasOwnProperty.call(e,"getName")||"function"!=typeof e.getName)}},{key:"registerComponent",value:function(t){var r=this;if(t.hasOwnProperty("_providers")){var n=t._providers;n&&this._checkObject(n)?Object.keys(n).forEach(function(e){n&&n.hasOwnProperty(e)&&r.registerService(t,e,n[e])}):c(!1,"providers not object")}this.rootProviders.length&&this.rootProviders.forEach(function(e){r._checkGetName(e)&&r.registerService(t,e.getName(),e)})}},{key:"registerService",value:function(e,t,r){var n=this;this.services.has(r)||"Injectable"!==r.name||this.services.set(r,new r(this.app));var o=this.services.get(r);if(o&&o instanceof f){if(o.import)if(this._checkObject(o.import)){var i=Object.keys(o.import).map(function(e){return{name:e,service:n.registerService(o,e,o.import[e])}}).filter(function(e){return e.service instanceof f});this._injectService(o,i)}else c(!1,"providers not object");return this._injectService(e,[{name:t,service:o}]),o}c(!1,"no decorator Injectable or extends Inject")}},{key:"set",value:function(e){if(this._checkGetName(e)){var t=this.registerService(this.app,e.getName(),e);t&&t instanceof f&&this.services.set(e,t)}}},{key:"get",value:function(e){return this.services.has(e)||this.set(e),this.services.get(e)}}]),r}();function p(n){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e){function r(e){i(this,r),Reflect.defineProperty(n.prototype,"name",{enumerable:!1,get:function(){return n.name}}),o&&o.hasOwnProperty("context")&&Reflect.defineProperty(n.prototype,"context",{enumerable:!1,get:function(){return o.context}}),o&&o.hasOwnProperty("import")&&Reflect.defineProperty(n.prototype,"import",{enumerable:!1,get:function(){return o.import}}),Reflect.defineProperty(n.prototype,"vm",{enumerable:!1,get:function(){return e}});var t=a(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return t.isVueService=!0,t}return u(r,n),s(r,null,[{key:"getName",value:function(){return n.name}}]),r}()}var h=function(){function o(){var e=arguments;i(this,o),this.rootProviders=[],this.app=null,this.provider=null,this.apps=[];for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=e[n];this.rootProviders=r}return s(o,[{key:"init",value:function(e){this.apps.push(e),this.app||(this.app=e,this.provider=new r(this.app,this.rootProviders))}},{key:"initComponent",value:function(e){this.provider&&this.provider.registerComponent(e)}},{key:"get",value:function(e){return this.provider&&this.provider.get(e)}}]),o}();h.install=function e(t){if(!e.installed||o!==t){e.installed=!0;var n=function(e){return void 0!==e},r=function(e,t){var r=e.$options._parentVnode;n(r)&&n(r=r.data)&&n(r=r.registerRouteInstance)&&r(e,t)};(o=t).mixin({beforeCreate:function(){n(this.$options.providers)&&(this._providers=this.$options.providers),n(this.$options.injector)?((this._injectorRoot=this)._injector=this.$options.injector,this._injector.init(this)):(this._injectorRoot=this.$parent&&this.$parent._injectorRoot||this,this._injectorRoot._injector.initComponent(this)),r(this,this)},destroyed:function(){r(this)}}),Object.defineProperty(t.prototype,"$injector",{get:function(){return this._injectorRoot._injector}})}},h.version="1.0.4",t&&window.Vue&&window.Vue.use(h),e.Injectable=function(t){return"function"==typeof t?p(t):function(e){return p(e,t)}},e.Inject=f,e.Service=function(n){return o=function(e,t,r){(e.providers||(e.providers={}))[t]=n},function(e,t,r){var n="function"==typeof e?e:e.constructor;n.__decorators__||(n.__decorators__=[]),"number"!=typeof r&&(r=void 0),n.__decorators__.push(function(e){return o(e,t,r)})};var o},e.default=h,Object.defineProperty(e,"__esModule",{value:!0})});