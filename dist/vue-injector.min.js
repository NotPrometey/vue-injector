/*!
  * @scandltd/vue-injector v1.0.2
  * (c) 2018 Scandltd
  * @license GPL-2.0
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.VueInjector={})}(this,function(e){"use strict";var o=void 0;function c(e,t){if(!e)throw new Error("[@scandltd/vue-injector] "+t)}var t="undefined"!=typeof window,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},s=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),u=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},f=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},p=function e(){i(this,e)},r=function(){function t(e){i(this,t),this.app=e,this.services=new Map}return s(t,[{key:"_injectService",value:function(n,e){e.forEach(function(e){var t=e.name;!Object.hasOwnProperty.call(n,t)&&e.service&&Reflect.defineProperty(n,t,{enumerable:!0,get:function(){return e.service}})})}},{key:"_checkObject",value:function(e){return!Array.isArray(e)&&"object"===(void 0===e?"undefined":n(e))&&null!==e}},{key:"registerComponent",value:function(t){var n=this;if(t.hasOwnProperty("_providers")){var r=t._providers;r&&this._checkObject(r)?Object.keys(r).forEach(function(e){r&&r.hasOwnProperty(e)&&n.registerService(t,e,r[e])}):c(!1,"providers not object")}}},{key:"registerService",value:function(e,t,n){var r=this;this.services.has(n)||"Injectable"!==n.name||this.services.set(n,new n(this.app));var o=this.services.get(n);if(o&&o instanceof p){if(o.import)if(this._checkObject(o.import)){var i=Object.keys(o.import).map(function(e){return{name:e,service:r.registerService(o,e,o.import[e])}}).filter(function(e){return e.service instanceof p});this._injectService(o,i)}else c(!1,"providers not object");return this._injectService(e,[{name:t,service:o}]),o}c(!1,"no decorator Injectable or extends Inject")}},{key:"get",value:function(e){if(!this.services.has(e)){var t=this.registerService(this.app,e.getName(),e);t&&t instanceof p&&this.services.set(e,t)}return this.services.get(e)}}]),t}();function a(r){var o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return function(e){function n(e){i(this,n),Reflect.defineProperty(r.prototype,"name",{enumerable:!1,get:function(){return r.name}}),o&&o.hasOwnProperty("context")&&Reflect.defineProperty(r.prototype,"context",{enumerable:!1,get:function(){return o.context}}),o&&o.hasOwnProperty("import")&&Reflect.defineProperty(r.prototype,"import",{enumerable:!1,get:function(){return o.import}}),Reflect.defineProperty(r.prototype,"vm",{enumerable:!1,get:function(){return e}});var t=f(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.isVueService=!0,t}return u(n,r),s(n,null,[{key:"getName",value:function(){return r.name}}]),n}()}var h=function(){function e(){i(this,e),this.app=null,this.provider=null,this.apps=[]}return s(e,[{key:"init",value:function(e){this.apps.push(e),this.app||(this.app=e,this.provider=new r(this.app))}},{key:"initComponent",value:function(e){this.provider&&this.provider.registerComponent(e)}},{key:"get",value:function(e){return this.provider&&this.provider.get(e)}}]),e}();h.install=function e(t){if(!e.installed||o!==t){e.installed=!0;var r=function(e){return void 0!==e},n=function(e,t){var n=e.$options._parentVnode;r(n)&&r(n=n.data)&&r(n=n.registerRouteInstance)&&n(e,t)};(o=t).mixin({beforeCreate:function(){r(this.$options.providers)&&(this._providers=this.$options.providers),r(this.$options.injector)?((this._injectorRoot=this)._injector=this.$options.injector,this._injector.init(this)):(this._injectorRoot=this.$parent&&this.$parent._injectorRoot||this,this._injectorRoot._injector.initComponent(this)),n(this,this)},destroyed:function(){n(this)}}),Object.defineProperty(t.prototype,"$injector",{get:function(){return this._injectorRoot._injector}})}},h.version="1.0.2",t&&window.Vue&&window.Vue.use(h),e.Injectable=function(t){return"function"==typeof t?a(t):function(e){return a(e,t)}},e.Inject=p,e.Service=function(r){return o=function(e,t,n){(e.providers||(e.providers={}))[t]=r},function(e,t,n){var r="function"==typeof e?e:e.constructor;r.__decorators__||(r.__decorators__=[]),"number"!=typeof n&&(n=void 0),r.__decorators__.push(function(e){return o(e,t,n)})};var o},e.default=h,Object.defineProperty(e,"__esModule",{value:!0})});