/*!
  * @scandltd/vue-injector v1.0.5
  * (c) 2018 Scandltd
  * @license GPL-2.0
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.VueInjector={})}(this,function(t){"use strict";var n;function c(t,e){if(!t)throw new Error("[@scandltd/vue-injector] "+e)}var e="undefined"!=typeof window,s=function(){},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){function t(t,e){this.rootProviders=[],this.app=t,this.rootProviders=e,this.services=new Map}return t.prototype._injectService=function(r,t){t.forEach(function(t){var e=t.name;!Object.hasOwnProperty.call(r,e)&&t.service&&Reflect.defineProperty(r,e,{enumerable:!0,get:function(){return t.service}})})},t.prototype._checkObject=function(t){return!Array.isArray(t)&&"object"===(void 0===t?"undefined":r(t))&&null!==t},t.prototype._checkGetName=function(t){return!(!Object.hasOwnProperty.call(t,"getName")||"function"!=typeof t.getName)},t.prototype.registerComponent=function(e){var r=this;if(e.hasOwnProperty("_providers")){var o=e._providers;o&&this._checkObject(o)?Object.keys(o).forEach(function(t){o&&o.hasOwnProperty(t)&&r.registerService(e,t,o[t])}):c(!1,"providers not object")}this.rootProviders.length&&this.rootProviders.forEach(function(t){r._checkGetName(t)&&r.registerService(e,t.getName(),t)})},t.prototype.registerService=function(t,e,r){var o=this;this.services.has(r)||"Injectable"!==r.name||this.services.set(r,new r(this.app));var n=this.services.get(r);if(n&&n instanceof s){if(n.import)if(this._checkObject(n.import)){var i=Object.keys(n.import).map(function(t){return{name:t,service:o.registerService(n,t,n.import[t])}}).filter(function(t){return t.service instanceof s});this._injectService(n,i)}else c(!1,"providers not object");return this._injectService(t,[{name:e,service:n}]),n}c(!1,"no decorator Injectable or extends Inject")},t.prototype.set=function(t){if(this._checkGetName(t)){var e=this.registerService(this.app,t.getName(),t);e&&e instanceof s&&this.services.set(t,e)}},t.prototype.get=function(t){return this.services.has(t)||this.set(t),this.services.get(t)},t}(),i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function p(o,n){return void 0===n&&(n={}),function(r){function t(t){var e=r.call(this)||this;return e.isVueService=!0,Reflect.defineProperty(o.prototype,"name",{enumerable:!1,get:function(){return o.name}}),n&&n.hasOwnProperty("context")&&Reflect.defineProperty(o.prototype,"context",{enumerable:!1,get:function(){return n.context}}),n&&n.hasOwnProperty("import")&&Reflect.defineProperty(o.prototype,"import",{enumerable:!1,get:function(){return n.import}}),Reflect.defineProperty(o.prototype,"vm",{enumerable:!1,get:function(){return t}}),e=r.call(this)||this}return function(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(t,r),t.getName=function(){return o.name},t}(o)}var u=function(){function t(){for(var t=arguments,e=[],r=0;r<arguments.length;r++)e[r]=t[r];this.rootProviders=[],this.app=null,this.provider=null,this.apps=[],this.rootProviders=e}return t.prototype.init=function(t){this.apps.push(t),this.app||(this.app=t,this.provider=new o(this.app,this.rootProviders))},t.prototype.initComponent=function(t){this.provider&&this.provider.registerComponent(t)},t.prototype.get=function(t){return this.provider&&this.provider.get(t)},t}();u.install=function t(e){if(!t.installed||n!==e){t.installed=!0;var o=function(t){return void 0!==t},r=function(t,e){var r=t.$options._parentVnode;o(r)&&o(r=r.data)&&o(r=r.registerRouteInstance)&&r(t,e)};(n=e).mixin({beforeCreate:function(){o(this.$options.providers)&&(this._providers=this.$options.providers),o(this.$options.injector)?((this._injectorRoot=this)._injector=this.$options.injector,this._injector.init(this)):(this._injectorRoot=this.$parent&&this.$parent._injectorRoot||this,this._injectorRoot._injector.initComponent(this)),r(this,this)},destroyed:function(){r(this)}}),Object.defineProperty(e.prototype,"$injector",{get:function(){return this._injectorRoot._injector}})}},u.version="1.0.5",e&&window.Vue&&window.Vue.use(u),t.Injectable=function(e){return"function"==typeof e?p(e):function(t){return p(t,e)}},t.Inject=s,t.Service=function(o){return n=function(t,e,r){(t.providers||(t.providers={}))[e]=o},function(t,e,r){var o="function"==typeof t?t:t.constructor;o.__decorators__||(o.__decorators__=[]),"number"!=typeof r&&(r=void 0),o.__decorators__.push(function(t){return n(t,e,r)})};var n},t.default=u,Object.defineProperty(t,"__esModule",{value:!0})});